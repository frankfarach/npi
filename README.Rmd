---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
library(npi)
library(tidyverse)
nyc <- npi:::res
```

# npi
> Access the U.S. National Provider Identifier Registry API
  
  [![lifecycle](https://img.shields.io/badge/lifecycle-maturing-blue.svg)](https://www.tidyverse.org/lifecycle/#maturing)
  [![Travis build status](https://travis-ci.org/frankfarach/npi.svg?branch=master)](https://travis-ci.org/frankfarach/npi)
  [![AppVeyor Build Status](https://ci.appveyor.com/api/projects/status/github/frankfarach/npi?branch=master&svg=true)](https://ci.appveyor.com/project/frankfarach/npi)
  [![Coverage status](https://codecov.io/gh/frankfarach/npi/branch/master/graph/badge.svg)](https://codecov.io/github/frankfarach/npi?branch=master)

Use R to access the U.S. National Provider Identifier (NPI) Registry API (v2.1) by the Center for Medicare and Medicaid Services (CMS): https://npiregistry.cms.hhs.gov/. Obtain rich administrative data linked to a specific individual or organizational healthcare provider, or perform advanced searches based on provider name, location, type of service, credentials, and many other attributes. `npi` provides convenience functions for data extraction so you can spend less time wrangling data and more time putting data to work.

## Installation

Install `npi` directly from Github using the `devtools` package:

```{r install, eval = FALSE}
devtools::install_github("frankfarach/npi")
library(npi)
```

## Usage

`npi` exports three functions:

 * `search_npi()`: Search the NPI Registry and return the response as a [tibble](http://tibble.tidyverse.org/) with high-cardinality data organized into list columns.
 * `get_list_col()`: Unnest a list column from a `search_npi()` result, joined by NPI number.
 * `is_valid_npi()`: Check the validity of one or more NPI numbers using the official [NPI enumeration standard](https://www.cms.gov/Regulations-and-Guidance/Administrative-Simplification/NationalProvIdentStand/Downloads/NPIcheckdigit.pdf).

### Search the registry

`search_npi()` exposes nearly all of the NPPES API's [search parameters](https://npiregistry.cms.hhs.gov/registry/help-api). Let's say you wanted to find up to 5 organizational providers with primary locations in New York City. That's one line:

```r
nyc <- search_npi(city = "New York City", provider_type = 2, limit = 5)
```
```{r print-nyc}
nyc
```

The full search results have four regular vector columns, `npi`, `provider_type`, `created_date`, and `last_updated_date` and seven list columns. Each list column is a collection of related data:

 * `basic`: Basic profile information about the provider
 * `other_names`: Other names used by the provider
 * `identifiers`: Other provider identifiers and credential information
 * `taxonomies`: Service classification and license information
 * `addresses`: Location and mailing address information
 * `practice_locations`: Provider's practice locations
 * `endpoints`: Details about provider's endpoints for health information exchange

Although the resulting tibble is somewhat complex, `npi` has you covered with convenience functions to summarize and extract just the data you need.

## Working with search results 

Run `summary()` on your results to see what you've got:

```{r summarize-nyc}
summary(nyc)
```

Use `get_list_col()` to extract and unnest data by list column while preserving its relationship with NPI:

```{r unnest}
# Get the `basic` list column from `nyc` using npi as the key
basic <- get_list_col(df = nyc, list_col = basic, key = npi)
basic

# Get the `taxonomies` list column joined to NPI
tax <- get_list_col(nyc, taxonomies, npi)
tax
```

By repeating this process with other list columns, you can create multiple tidy data frames and join them to make your own master tidy data frame.

```{r multiple_listcols}
# Join basic and taxonomies by `npi`
left_join(basic, tax, by = "npi")
```

### Validating NPIs

Use `is_valid_npi()` to check whether a candidate number is a valid NPI number:

```{r valid_npi_ex}
# Validate one-off NPIs
is_valid_npi(1234567893)
is_valid_npi(1234567898)
```

## Code of Conduct

Please note that this project is released with a [Contributor Code of Conduct](CODE_OF_CONDUCT.md). By participating in this project you agree to abide by its terms.

## License

MIT (c) [Frank Farach](https://github.com/frankfarach)
